---
title: "Neighbourhood Crime in Toronto (2019–2024)"
subtitle: "Analyzing Crime Trends in Low, Medium, and High Socioeconomic Areas"
author: 
  - name: "Mike Cowan"
    affiliation: "University of Toronto"
thanks: |
  Code and data are available at: [https://github.com/mcowan38/tswd_toronto_crime].
date: "19 May 2025"
date-format: long
execute:
  echo: false
abstract: This paper examines how neighbourhood-level crime trajectories in Toronto evolved from 2019 through 2024, using socioeconomic clustering to identify crime rate divergence across 159 Toronto neighbourhoods. Drawing on data from the 2021 Canadian Census and the Toronto Police Service, we applied $K$-means clustering to group neighbourhoods into three socioeconomic categories reflecting relative socioeconomic advantage (High-, Medium-, and Low- Opportunity) and compared crime rates across these clusters over time. Across all four crime types, Low Opportunity neighbourhoods experienced persistently higher rates—especially for assault and shootings—while High Opportunity areas remained relatively insulated. Following a city-wide decline in break-and-enters during the 2020 lockdown, crime rebounded steeply in deprived areas, with robbery and gun violence disproportionately escalating through 2023. These findings highlight persistent socioeconomic disparities in crime exposure, with disadvantaged neighbourhoods bearing a disproportionate share of urban crime.
format: 
  pdf: 
    fig-pos: "H"
    number-sections: true
    bibliography: references.bib
    csl: styles/apa.csl

---
```{python}
# | label: global_options
# | include: false
# | warning: false
# | message: false
# | echo: false

#### Modules ####
import polars as pl
import numpy as np
import matplotlib.pyplot as plt
import matplotlib as mpl
import matplotlib.font_manager as fm
from pathlib import Path
from sklearn.preprocessing import StandardScaler
from sklearn.decomposition import PCA
from sklearn.cluster import KMeans
from sklearn.mixture import GaussianMixture
from sklearn.metrics import (
    silhouette_score,
    davies_bouldin_score,
    calinski_harabasz_score,
)

#### Standardize Figure Font in matplotlib ####
# [https://matplotlib.org/stable/users/explain/text/usetex.html]
# [https://ctan.org/pkg/cm-unicode]

font_path = Path("fonts/cmunrm.otf").resolve()
fm.fontManager.addfont(font_path)
cmu_font = fm.FontProperties(fname=str(font_path))

mpl.rcParams.update(
    {
        "font.family": cmu_font.get_name(),  # Should be "CMU Roman"
        "mathtext.fontset": "cm",
        "axes.unicode_minus": False,
    }
)

# Hide column types (i.e., no i64, str, f64 identifiers)
pl.Config.set_tbl_hide_column_data_types(True)

# Force max characters on tables wrap
pl.Config.set_tbl_width_chars(5)

#### Load data ####
crime_raw = pl.read_csv("../data/01-raw_data/neighbourhood_crime.csv")
profile_raw = pl.read_excel("../data/01-raw_data/neighbourhood_profiles.xlsx")
merged_data = pl.read_csv("../data/02-analysis_data/02-analysis_data_merged.csv")
rates_change = pl.read_csv("../data/02-analysis_data/04-cluster_crime_rates.csv")

#### Crime setup #####
crime_types = ["assault", "breakenter", "robbery", "shooting"]
years = [2019, 2020, 2021, 2022, 2023, 2024]

#### SES columns #####
ses_columns = [
    "education_rate",
    "prop_single_parent",
    "unemployment_rate",
    "median_income",
]

#### Scaling ####
ses_columns = [
    "education_rate",
    "prop_single_parent",
    "unemployment_rate",
    "median_income",
]
X = merged_data.select(ses_columns).to_numpy()
X_scaled = StandardScaler().fit_transform(X)

#### PCA Coordinates ####
pca_coords = PCA(n_components=2).fit_transform(X_scaled)

#### Configure Clusters ####
cluster_configs = [
    ("KMeans", 2, "Paired", "KMeans (k=2)"),
    ("GMM", 2, "Accent", "GMM (k=2)"),
    ("KMeans", 3, "Set1", "KMeans (k=3)"),
    ("GMM", 3, "Set2", "GMM (k=3)"),
]
```

# Introduction

The COVID-19 pandemic disrupted social and economic systems worldwide—and crime trends were no exception. In Canada, police-reported incidents plummeted in 2020 before rebounding sharply in 2021 (Statistics Canada, 2021), with violent crime surging 5% above pre-pandemic levels while property crime fell to historic lows.

However, these national trends obscure local disparities; crime clusters unevenly across urban spaces, concentrated in areas marked by structural inequities—e.g., income inequality, educational disparities, and labour market marginalization [@mohammadi_2022_homicide; @wang_2019_the]. This spatial unevenness is particularly pronounced in Toronto, Canada’s largest city, where neighbourhoods diverge sharply in socioeconomic conditions—from affluent enclaves to zones of concentrated disadvantage [@jargowsky_2015_concentrated]. A plethora of research confirms that these inequalities stratify crime patterns, making city-wide or national averages poor proxies for local realities [@wang_2019_the; @uesugi_2024_a; @yu_2025_how].

Building on this established research, this paper examines how Toronto’s neighbourhood-level crime patterns evolved during the pandemic and its aftermath. We analyze official crime counts for Toronto’s neighbourhoods from 2019 through 2024, assessing how pre-existing social and economic inequalities—often termed “opportunity” or “advantage” differences [@yu_2025_how]—relate to diverging crime trends. Specifically, we classify Toronto neighbourhoods into Low-, Medium-, and High-Opportunity clusters via $K$-means clustering on socioeconomic proxies and compare the crime trajectories of these clusters over time. 

This paper proceeds as follows: First, we ground our analysis in criminological frameworks—i.e., social disorganization and strain—which help explain how neighbourhood opportunity structures (e.g., income, education, employment) may condition crime trends. Next, we describe our data and methodological approach, justifying our construction of neighbourhood opportunity clusters and analyzing their distinct crime trajectories from 2019-2024. Practically, we consider what our neighbourhood-level results suggest for urban crime policy.

# Literature Review

Criminological theory and empirical evidence converge on two insights in urban crime literature: (1) neighbourhood-level structural conditions fundamentally shape crime, and (2) spatial inequalities between neighbourhoods amplify these effects.

Social disorganization theory suggests that poverty, residential instability, ethnic heterogeneity, and family disruption erode collective efficacy—the capacity of communities to enforce informal social controls. The resulting conditions create criminogenic environments where crime flourishes due to weakened guardianship and institutional neglect [@antunes_2021_social; @frevel_2021_local]. Strain theory complements this perspective, arguing that material deprivation and relative disadvantage generate frustration that may motivate criminal coping strategies particularly during systemic crises-e.g., the COVID-19 pandemic [@antunes_2021_social].

Contemporary research extends these theories by emphasizing the study of spatial inequality—the juxtaposition of affluence and deprivation across proximate neighbourhoods. For example, Kang (2016) demonstrates that inter-neighbourhood income disparities, rather than city-wide inequality alone, predict localized violence, suggesting that proximity to wealth exacerbates perceptions of exclusion and strain. These findings align with contemporary research in Paterson, NJ, which suggested median household income exerted the strongest neighbourhood-level influence on crime patterns [@yu_2025_how's].

Unsurprisingly, decades of evidence confirm that concentrated disadvantage—marked by poverty, unemployment, and single-parent households—correlates strongly with elevated crime rates [@frevel_2021_local; @jargowsky_2015_concentrated]. Toronto exemplifies this dynamic: neighbourhoods with higher marginalization indices exhibit disproportionately high rates of violent and property crime [@wang_2019_the], while areas with entrenched poverty report elevated homicide incidence [@mohammadi_2022_homicide]. However, the spatial heterogeneity of these relationships in major cities is also critical. For example, geographically weighted regression studies in Chicago [@arnio_2012_demography] and Tokyo [@uesugi_2024_a] reveal that the strength—and even the direction—of socioeconomic predictors of burglary or robbery vary across neighbourhoods, demonstrating the need for crime models that are sensitive to local socioeconomic dynamics.

The COVID-19 pandemic undoubtedly exposed and amplified these spatial inequities. Initial lockdowns reduced city-wide crime through diminished routine activities, but declines in some cities were uneven [@andresen_2022_in]. For instance, while property crime in Vancouver decreased in wealthy neighbourhoods with robust security infrastructure, violent crime surged in disadvantaged areas strained by disrupted social services and weakened guardianship.

These disparities underscore three critical lessons: first, structural disadvantage predicts vulnerability to crime spikes during crises, aligning with social disorganization theory’s emphasis on resource-deprived communities. Second, inter-neighbourhood inequality magnifies criminogenic risks, as strain theory posits when relative deprivation fuels frustration. Third, opportunity structures—access to security, institutional support, and economic stability—can be spatially stratified, privileging affluent areas with systemic advantages.

Building on these insights, we operationalize “opportunity” as relative access to stabilizing socioeconomic conditions—a small composite measure proxied by median income, educational attainment, employment status, and household structure. Our analysis, focusing on Toronto neighbourhoods, compliments prior research in two ways: first, we expand the temporal scope to 2019–2024, assessing whether pandemic-era disparities persisted into the recovery phase. Second, we apply $K$-means clustering to classify neighbourhoods into High-, Medium-, and Low-Opportunity clusters using variables (income, education, employment) empirically shown to influence crime patterns [@yu_2025_how]. If social disorganization and strain theories hold, Low-Opportunity clusters should exhibit both higher baseline crime rates and greater volatility during disruptions, reflecting their structural precarity.

# Data {#sec-data}

We use the programming language Python [@python] alongside polars [@polars] and sci-kit-learn [@scikit-learn] for the paper's data cleaning and analysis.\footnote{Workflow and GitHub-based project structure follow best practices guided by Alexander (2023), which has proven to be an excellent resource: [https://tellingstorieswithdata.com]}.

### Neighbourhood Crime Data

We sourced crime data from the Open Data Toronto Portal [@citeOpenDataToronto], which includes assaults, break-and-enters, robberies, and shootings—the types of crime we chose to analyze between 2019 and 2024. Each entry includes incident years and total counts by neighbourhood (see @tbl-crime_data_preview).

```{python}
# | label: tbl-crime_data_preview
# | tbl-cap: Toronto Crime Data (2014-2024)
# | tbl-cap-location: top
# | echo: false

#### Glimpse crime table ####
crime_glimpse = crime_raw.select(
    [
        # Remove quotes from AREA_NAME values
        pl.col("_id"),
        pl.col("AREA_NAME").str.slice(0, 16),  # keep only first 16 characters
        # Replace nulls with 0 in numeric columns
        pl.col("HOOD_ID"),
        pl.col("ASSAULT_2014").fill_null(0),
        pl.col("BREAKENTER_2014").fill_null(0),
        pl.lit("").alias("Robbery_2014").alias("…"),  # fake truncate
    ]
)

#### Display ####
crime_glimpse
```

*Note.* @tbl-crime_data_preview previews Toronto Police crime data for 2014–2024. Columns include neighbourhood identifiers and annual counts of major crimes, truncated for display.

### Neighbourhood Census Profiles
2021 Toronto Census Profile data was obtained from the Open Data Toronto Portal [@citeOpenDataToronto]. This data was transformed to align with neighbourhood identifiers used in the crime dataset (see @tbl-census_data_preview).

```{python}
# | label: tbl-census_data_preview
# | tbl-cap: Toronto Neighbourhood Census Data (2021)
# | tbl-cap-location: top
# | echo: false

#### Glimpse profile table ####
profile_glimpse = (
    profile_raw.select(
        [
            pl.col("Neighbourhood Name").str.slice(0, 24),
            pl.col("West Humber-Clairville").alias("West Humber"),
            pl.col("Mount Olive-Silverstone-Jamestown").alias("Mt. Olive"),
            pl.col("Thistletown-Beaumond Heights").alias("Thistletown"),
            pl.col("Elms-Old Rexdale").alias("Elms-Old"),
            pl.lit("").alias("…"),  # fake truncate
        ]
    )
    .with_row_index("row_nr")
    .filter(pl.col("row_nr") != 1)
    .drop("row_nr")
)

#### Display ####
profile_glimpse
```

*Note.* @tbl-census_data_preview previews the 2021 Toronto Census dataset. Columns include standardized socioeconomic indicators (e.g., education rate, household income) across selected neighbourhoods. Names and values have been truncated for display.

## Measurement

Transforming the lived realities of Toronto’s neighbourhoods into data suitable for our analysis required two steps: (1) constructing a composite socioeconomic profile for each neighbourhood and (2) aggregating police‐reported crime counts to rate units. 

From the Census data, we extracted four attributes that decades of criminological research identify as correlates of neighbourhood crime: median household income, share of adults with a bachelor’s degree or higher, unemployment rate, and proportion of single-parent families. 

From the crime dataset, we aggregated annual counts of assaults, break-and-enters, robberies and shootings (2019–2024) and transformed them into rates per 100,000 persons using neighbourhood-level population denominators.

These two sources were paired by Toronto’s 159 neighbourhoods, yielding socioeconomic features and crime rates from the early pre- to post-COVID-19 pandemic.

# Model

Cognizant of prior criminological studies—which have employed powerful spatial models to characterize neighbourhood heterogeneity in crime and socioeconomic conditions (utilizing substantially more predictors; [@mohammadi_2022_homicide; @uesugi_2024_a; @wang_2019_the; @yu_2025_how])—we apply $K$-means clustering to four standardized indicators—education rate, proportion of single-parent households, unemployment rate, and median household income—to cluster neighbourhoods based on their socioeconomic similarity.

The $K$-means algorithm identifies the set of cluster centroids ${\mu_k}$ that minimizes the total within-cluster sum of squared distances (WCSS)\footnote{Mathematicals have been adapted from Hastie et al. (2009).}. In simple terms, the algorithm partitions observations into $K$ groups such that data points within each group are as similar as possible to one another. Similarity is measured by the squared Euclidean distance between each observation and the average of its assigned group—called the cluster centroid. The goal is to find centroid locations that minimize the total variation within each cluster, producing compact and well-separated groups.

Let $\mathbf{x}i = (x{i1}, x_{i2}, x_{i3}, x_{i4})$ denote the four-dimensional vector of z-scored socioeconomic features for neighbourhood $i$, where $i = 1, \dots, N = 159$. Each vector includes standardized values for (1) median household income, (2) the proportion of residents with a bachelor’s degree or higher, (3) the unemployment rate, and (4) the single-parent household rate.

Each raw feature os standardized by 
$$
x_{ij}^{\mathrm{scaled}} = \frac{x_{ij} - \overline{x}_j}{s_j},
$$  

where $\overline{x}_j$ and $s_j$ are the sample mean and standard deviation of feature $j$.

We then partition $\{\mathbf{x}_i\}_{i=1}^N$ into $K = 3$ clusters using the $K$-means algorithm, minimizing the WCSS:  
$$
\{\boldsymbol{\mu}_k\}_{k=1}^3
= \arg\min_{\{\mu_k\}}
\sum_{i=1}^N \bigl\|\mathbf{x}_i - \mu_{z_i}\bigr\|^2,
$$

where $\mu_{z_i}$ is the centroid of neighbourhood $i$’s assigned cluster.

We tested $K = 2, \dots, 5$ and selected $K = 3$ based on silhouette diagnostics (see @sec-model-evaluation). Additionally, Principal Components Analysis—conducted as a diagnostic check—showed that the first two components explain ~89% of total variance, confirming a strong low-dimensional socioeconomic gradient underlying the four indicators.

We adopted a three-group classification—High, Medium, and Low Opportunity—aligned with standard socioeconomic strata commonly used in policy discourse and everyday language (i.e., upper, middle, and lower class). Based on this scheme, the resulting clusters are labelled as shown in @tbl-cluster_stats below.
```{python}
# | label: tbl-cluster_stats
# | tbl-cap: Descriptive Statistics by SES Cluster (2019–2024)
# | tbl-cap-location: top
# | echo: false

#### Descriptive Statistics ####
# Summary by cluster
cluster_summary = (
    merged_data.group_by("cluster")
    .agg(
        [
            pl.count("neighbourhood").alias("Neighbourhoods (n)"),
            pl.mean("median_income").alias("Avg. Median Income ($)"),
            pl.mean("prop_single_parent").round(2).alias("Single-Parent Proportion"),
            (pl.mean("education_rate")).round(2).alias("Education Rate"),
            (pl.mean("unemployment_rate")).round(2).alias("Unemployment Rate"),
        ]
    )
    .sort("cluster")
    .rename({"cluster": "Cluster"})
)

#### Display ####
cluster_summary
```

*Note.* @tbl-cluster_stats presents the average socioeconomic features by cluster for Toronto neigbourhoods over 2019–2024. Clusters were derived via $K$-means clustering on standardized education rate, proportion of single-parent households, unemployment rate, and median household income. High-Opportunity (Cluster 0) neighbourhoods exhibit high educational attainment and median income alongside low unemployment and single-parent household rates. Medium-Opportunity (Cluster 1) neighbourhoods display a mixed socioeconomic profile. Low-Opportunity (Cluster 2) neighbourhoods are characterized by lower education and income, and higher unemployment and single-parent household rates. All values represent means of each indicator across the study period. **Needs reshaping**

Although we also explored Gaussian Mixture Models (GMM)\footnote{GMM models the data as a mixture of $K$ multivariate normal distributions, estimating a mean vector and covariance matrix for each component.}—which relax the spherical cluster assumption imposed by $K$-means [@scikit-learn—we], we retained the $K$-means technique due to its superior evaluation scores and greater interpretability (both methods produced broadly similar neighbourhood groupings; see @fig-cluster_pca).


# Results

Our results are summarized in @fig-crime_trends.

```{python}
# | label: fig-crime_trends
# | fig-cap: Average Crime Rate Trends by Socioeconomic Cluster (2019–2024)
# | fig-cap-location: top
# | echo: false

### Trends plot ####
# Create combined 2x2 figure
fig, axes = plt.subplots(2, 2, figsize=(12, 8))
axes = axes.flatten()

# Loop through each crime type and plot trends by SES cluster #
for idx, crime in enumerate(crime_types):
    rate_cols = [f"{crime}_rate_{year}" for year in years]

    # Unpivot wide to long for time-series, extract year as integer
    merged_long = (
        merged_data.select(
            ["Socioeconomic_index", *rate_cols])
        .unpivot(
            on=rate_cols,
            index="Socioeconomic_index",
            variable_name="year",
            value_name="rate",
        )
        .with_columns(pl.col("year").str.extract(r"_(\d{4})$", 1).cast(pl.Int64))
    )

    # Group by SES and year
    trend = (
        merged_long.group_by(["Socioeconomic_index", "year"])
        .agg(pl.col("rate").mean().alias("average_rate"))
        .sort(["Socioeconomic_index", "year"])
    )

    # Plot in the 2x2 subplot
    ax = axes[idx]
    for group in ["Low Opportunity", "Medium Opportunity", "High Opportunity"]:
        sub = trend.filter(pl.col("Socioeconomic_index") == group)
        ax.plot(
            sub["year"].to_list(),
            sub["average_rate"].to_list(),
            marker="o",
            label=group,
        )

    ax.set_title(f"{crime.title()} Rate")
    ax.set_xlabel("Year")
    ax.set_ylabel("Rate per 100K persons")
    ax.legend(title="SES Cluster", fontsize=8)

#### Display ####
fig.tight_layout(rect=[0, 0.03, 1, 0.95])
plt.show()
```

*Note.* @fig-crime_trends plots trends in crime rates for Assault, Break-and-Enter, Robbery, and Shootings. For each year and crime type, the figure shows the mean rate across all neighbourhoods within each cluster.

Figure @fig-crime_trends illustrates how crime unfolded across Toronto’s neighbourhoods between 2019 and 2024. In Low-Opportunity neighbourhoods, assault rates edged upward from 758 to 805 incidents per 100,000 persons—an increase of 6.2%—while Medium-Opportunity areas saw an 8.0% rise, from 737 to 796 per 100,000. Even High-Opportunity neighbourhoods experienced a modest 8.0% uptick in assaults, climbing from 446 to 482 per 100,000.

By contrast, property-type and violent crimes more pronounced divergence. Robbery rates in High-Opportunity areas plunged by roughly one-third (a 34.5% reduction), falling from 95 to 62 per 100,000, whereas Low-Opportunity clusters recorded a smaller 16.9% decline (126 → 104). Medium-Opportunity wards registered an 18.5% drop (124 → 101). Shooting incidents fell most dramatically in Low-Opportunity areas—dropping from 27.95 to 15 per 100,000, a 44.0% decrease—while Medium- and High-Opportunity neighbourhoods saw reductions of 19.0% (10 → 8) and 18.5% (5 → 4), respectively.

The 2020 city-wide dip in break-and-enters—driven, in part, by greater residential presence—was particularly deep in deprived areas, where rates fell 26.0% from 246 to 182 per 100,000 between 2019 and 2020. However, by 2023 Low-Opportunity wards had rebounded to 214 incidents per 100,000—just 12.9% below their pre-pandemic level. Medium-Opportunity neighbourhoods saw a more sustained decline, with break-and-enters down 24.1% (329 → 249), while High-Opportunity areas only edged 2.2% above 2019 levels (348 → 356)\footnote{See Table 3 for tabular breakdown of year-to-year rate change.}. 

# Discussion

The patterns we observed across Toronto’s neighbourhoods from 2019 to 2024 align closely with the expectations derived from social disorganization and strain theories. As predicted, Low Opportunity areas—characterized by lower income, education, and employment levels, and higher single-parent prevalence—exhibited consistently elevated crime rates across all four crime types. Expectedly, these neighbourhoods began the pre-pandemic era with higher baseline crime levels but also demonstrated greater volatility in response to pandemic-related shocks.

Social disorganization theory helps explain these patterns by highlighting how concentrated disadvantage weakens collective efficacy and informal social control mechanisms [@frevel_2021_local]. The relatively rapid rebound in property crime and the persistent elevation of violent crime in less advantaged areas suggest that these neighbourhoods may lack the institutional buffers and community cohesion necessary to sustain safety gains during and after the 2020 lockdown. In contrast, High Opportunity neighbourhoods—presumably richer in social capital and surveillance infrastructure—remained largely insulated from post-pandemic escalations [@wang_2019_the].

Strain theory offers a complementary lens for interpreting the steeper rise in robbery and shootings in Low Opportunity clusters following 2020. These forms of violent and acquisitive crime may reflect cumulative stressors—e.g., economic hardship, institutional disengagement, and perceived exclusion—amplified by the pandemic [@antunes_2021_social]. The fact that Medium Opportunity areas also experienced upward trends in robbery and shootings suggests a broader diffusion of strain-related pressures, albeit less intensely than has been observed in structurally marginalized zones [@yu_2025_how].

Importantly, the growing gap between Low and Medium clusters—particularly in rates of robbery and gun violence—could indicate a deepening of intra-urban inequality. This dynamic resonates with spatial criminological findings that crime concentration is not only persistent but intensifying in the most structurally vulnerable areas [@mohammadi_2022_homicide; @uesugi_2024_a].

These findings reinforce multiple insights from prior criminology literature: (1) Structural disadvantage is predictive of elevated and volatile crime exposure; (2) Neighbourhoods vary in their capacity to absorb or rebound from systemic shocks [@andresen_2022_in]; (3) Socioeconomic opportunity is not merely correlated with crime rates, but mediates the resilience of communities during periods of crisis [@jargowsky_2015_concentrated, @kang_2016_inequality].

Taken together, the results underscore the importance of continuing to analyze urban crime through the dual lenses of structural inequality and spatial heterogeneity. The typological clustering approach employed here—grounded in census-derived socioeconomic indicators—provides a simple, replicable method for the first-pass identification of potential areas of concern, and understanding how patterns of crime map onto entrenched dimensions of social disorganization and strain.


## Limitations {#sec-limitations}

This study has several data-oriented limitations. First, our analysis is ecological in nature, drawing conclusions from neighbourhood-level aggregates rather than individual-level data. As such, we cannot determine whether individuals with certain socioeconomic characteristics are more likely to experience or perpetrate crime; we can only observe area-level patterns.

Second, the analysis relies solely on police-reported crime data, which are subject to well-documented limitations. Not all crimes are reported to law enforcement, and fluctuations in patrol coverage, resource allocation, or surveillance infrastructure can artificially inflate or deflate recorded incidents. These reporting inconsistencies likely vary across neighbourhoods, potentially skewing cross-area comparisons.

Additionally, the socioeconomic data we use are static, drawn from the 2021 Census. These indicators—income, education, unemployment, and single-parent status—cannot capture changes that occurred before or after 2021. Moreover, we excluded several potentially important variables—such as neighbourhood ethnic composition, immigration status, and residential mobility—which may shape both crime exposure and neighbourhood opportunity in substantive ways. As a result, our clustering captures only a partial view of structural disadvantage.

Fourth, our method for grouping neighbourhoods—$K$-means clustering—makes simplifying assumptions. It treats all four variables as equally important and assumes the clusters are roughly circular and evenly sized-while in reality, socioeconomic differences are rarely that tidy (@scikit-learn). Alternative clustering methods (e.g., GMM) might better reflect the true structure of the data.

Future research should address these gaps by using dynamic, multi-year socioeconomic data, incorporating a broader range of variables, and accounting for spatial relationships between neighbourhoods. In addition, combining quantitative patterns with qualitative accounts of neighbourhood residents could also help ground the numbers in the lived experiences of residents.

\newpage

\appendix

# Appendix {#sec-appendix}

## Model Evaluation {#sec-model-evaluation}

### Cluster Plots
A choice of socioeconomic index can meaningfully shift the resulting clusters. One straightforward approach is to standardize each indicator (e.g., income, education, unemployment) to z-scores and sum them [@vyas_2006_constructing]. Alternatively, factor analysis, which derives weights from latent dimensions (e.g., “Economic Capital” or “Family Stability”) can better reflect the structure among variables but requires more complex modelling and larger samples.

Given our inquiry is exploratory, we opted to employ $K$-Means. @fig-cluster_pca reduces our data to the first two principal components for visualization purposes. To guard against algorithmic artifacts, we place $K$-Means (hard, spherical boundaries) alongside Gaussian Mixture Models (soft, ellipsoidal groupings) [@scikit-learn]. Consistency across both methods strengthens confidence that our identified neighbourhood clusters reflect real socioeconomic patterns (and that we made the right selection).

```{python}
# | label: fig-cluster_pca
# | fig-cap: Clustering Techniques Comparison ($k = 2, 3$)
# | fig-cap-location: top
# | echo: false

#### Model Evaluation ####
fig, axes = plt.subplots(2, 2, figsize=(12, 10))
axes = axes.flatten()

for i, (model_type, k, cmap, title) in enumerate(cluster_configs):
    # instantiate
    if model_type == "KMeans":
        model = KMeans(n_clusters=k, random_state=42, n_init=10)
    else:
        model = GaussianMixture(n_components=k, random_state=42)
    labels = model.fit_predict(X_scaled)

    # Scatterplot
    scatterplot = axes[i].scatter(
        pca_coords[:, 0], pca_coords[:, 1], c=labels, cmap=cmap, alpha=0.8
    )
    axes[i].set_title(title)
    axes[i].set_xlabel("PC 1")
    axes[i].set_ylabel("PC 2")
    axes[i].legend(*scatterplot.legend_elements(), title="Cluster")

fig.tight_layout(rect=[0, 0.03, 1, 0.95])
plt.show()
```

*Note.* @fig-cluster_pca displays the two-dimensional projection of neighbourhoods, coloured by assigned cluster. At $k = 3$, GMM’s middle component (Cluster 1) overlaps with the Cluster 2, suggesting less clear separation at three clusters. Visually, $K$-Means ($k = 3$) appears to be the superior model choice.

### Evaluation Metrics

@fig-cluster_metrics presents a detailed comparison of clustering quality across $K$-means and Gaussian mixture models. We compute the Silhouette Score (ranging from –1 to 1; higher values indicate better cohesion and separation) to assess how closely each point is matched to its own cluster versus the next best alternative. The Davies–Bouldin Index measures the average similarity between each cluster and its most similar counterpart—lower values denote more compact, well-separated clusters. Finally, the Calinski–Harabasz Score quantifies the ratio of between-cluster dispersion to within-cluster dispersion—higher scores signify clearer, more distinct grouping.

```{python}
# | label: fig-cluster_metrics
# | fig-cap: Clustering Evaluation Metrics ($K$-means vs. Gaussian)
# | fig-cap-location: top
# | echo: false

#### Compute Evaluation Metrics ####
evaluation = []
for model_type in ["KMeans", "GMM"]:
    for k in [2, 3]:
        if model_type == "KMeans":
            # KMeans initialization:
            # n_clusters: number of clusters
            # random_state=42: seed for reproducibility
            # n_init=10: run 10 random initializations and pick the best
            m = KMeans(n_clusters=k, random_state=42, n_init=10)
        else:
            # GaussianMixture initialization:
            # n_components=k: number of mixture components (clusters)
            # random_state=42: seed for reproducibility
            m = GaussianMixture(n_components=k, random_state=42)
        lbls = m.fit_predict(X_scaled)
        evaluation.append(
            {
                "Model": model_type,
                "$k$": k,
                "Silhouette": silhouette_score(X_scaled, lbls),
                "Davies-Bouldin": davies_bouldin_score(X_scaled, lbls),
                "Calinski-Harabasz": calinski_harabasz_score(X_scaled, lbls),
            }
        )


#### Plot ####
metrics = ["Silhouette", "Davies-Bouldin", "Calinski-Harabasz"]
titles = [
    "Silhouette Score",
    "Davies–Bouldin Index",
    "Calinski–Harabasz Score",
]

fig, axs = plt.subplots(1, 3, figsize=(18, 5))
for idx, metric in enumerate(metrics):
    ax = axs[idx]
    x = np.arange(2)  # k = 2, 3
    width = 0.35
    for j, model_type in enumerate(["KMeans", "GMM"]):
        scores = [e[metric] for e in evaluation if e["Model"] == model_type]
        ax.bar(x + (j - 0.5) * width, scores, width, label=model_type)
    ax.set_xticks(x)
    ax.set_xticklabels(["$k = 2$", "$k = 3$"])
    ax.set_title(titles[idx])
    ax.set_xlabel("Clusters ($k$)")
    ax.set_ylabel(metric)
    ax.legend()

fig.tight_layout(rect=[0, 0.03, 1, 0.95])
plt.show()
```

*Note.* @fig-crime_trends shows three cluster‐validation metrics for both $K$-Means and Gaussian Mixture Models at $k = 2$ and $k = 3$. For $k = 2$, GMM produces a Silhouette Score of 0.141, Davies–Bouldin Index of 1.958, and Calinski–Harabasz Score of 30.4, whereas $K$-means achieves 0.429, 0.860, and 152.7, respectively. Increasing to $k = 3$ improves separation for GMM (Silhouette = 0.345; DB = 0.998; CH = 114.1) but slightly reduces cohesion for $K$-means (Silhouette = 0.424; DB = 0.786; CH = 133.0).

### Average Yearly Crime Rate Change by Neighbourhood

@tbl-rate_change_summary reports the annual percent change in mean crime rates per 100,000 persons for each SES cluster.

```{python}
# | label: tbl-rate_change_summary
# | tbl-cap: SES Cluster Crime Rate Change
# | tbl-cap-location: top
# | echo: false

#### Yearly crime rate change ####
# Select and rename columns
change_summary = rates_change.select(
    [
        pl.col("year").alias("Year"),
        pl.col("crime").alias("Crime"),
        pl.col("High Opportunity_pct_change").alias("High Opportunity (%)"),
        pl.col("Medium Opportunity_pct_change").alias("Medium Opportunity (%)"),
        pl.col("Low Opportunity_pct_change").alias("Low Opportunity (%)"),
    ]
)

#### Display ####
change_summary
```

*Note.* @tbl-rate_change_summary reports the annual percent change in crime rates for each SES cluster. Positive values indicating increases and negative values indicating decreases relative to the prior year. **Needs re-shaping**.

\newpage

# References